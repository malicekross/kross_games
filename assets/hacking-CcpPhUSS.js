const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Connection-BlPXsYj8.js","assets/modulepreload-polyfill-B5Qt9EMX.js"])))=>i.map(i=>d[i]);
import"./modulepreload-polyfill-B5Qt9EMX.js";const v="modulepreload",w=function(d){return"/kross_games/"+d},m={},x=function(t,e,o){let n=Promise.resolve();if(e&&e.length>0){let g=function(h){return Promise.all(h.map(l=>Promise.resolve(l).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),r=s?.nonce||s?.getAttribute("nonce");n=g(e.map(h=>{if(h=w(h),h in m)return;m[h]=!0;const l=h.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${u}`))return;const a=document.createElement("link");if(a.rel=l?"stylesheet":v,l||(a.as="script"),a.crossOrigin="",a.href=h,r&&a.setAttribute("nonce",r),document.head.appendChild(a),l)return new Promise((p,y)=>{a.addEventListener("load",p),a.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(s){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=s,window.dispatchEvent(r),!r.defaultPrevented)throw s}return n.then(s=>{for(const r of s||[])r.status==="rejected"&&i(r.reason);return t().catch(i)})},S="/kross_games/assets/sprites-ClHaEWzu.svg";class E{constructor(t){this.canvas=t,this.ctx=t.getContext("2d"),this.nodes=[],this.units=[],this.connections=[],this.lastTime=0,this.resize(),window.addEventListener("resize",()=>this.resize()),this.isDragging=!1,this.isCutting=!1,this.dragStartNode=null,this.cutStart={x:0,y:0},this.mouseX=0,this.mouseY=0,this.canvas.addEventListener("mousedown",e=>this.handleInputStart(e)),this.canvas.addEventListener("mousemove",e=>this.handleInputMove(e)),this.canvas.addEventListener("mouseup",e=>this.handleInputEnd(e)),this.sprites=new Image,this.sprites.src=S,this.spritesLoaded=!1,this.sprites.onload=()=>{this.spritesLoaded=!0}}resize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}start(){this.lastTime=performance.now(),requestAnimationFrame(t=>this.loop(t))}loop(t){const e=(t-this.lastTime)/1e3;this.lastTime=t,this.update(e),this.draw(),requestAnimationFrame(o=>this.loop(o))}update(t){this.nodes.forEach(e=>e.update(t)),this.connections.forEach(e=>e.update(t,this)),this.units.forEach(e=>e.update(t)),this.units=this.units.filter(e=>e.active),this.connections=this.connections.filter(e=>e.from.owner==="player"),this.updateScoreUI()}updateScoreUI(){let t=0,e=0;this.nodes.forEach(s=>{s.owner==="player"&&(t+=Math.floor(s.value)),s.owner==="enemy"&&(e+=Math.floor(s.value))}),this.units.forEach(s=>{s.owner==="player"&&t++,s.owner==="enemy"&&e++});const o=document.getElementById("player-score"),n=document.getElementById("enemy-score"),i=document.getElementById("score-bar-fill");if(o&&(o.innerText=t),n&&(n.innerText=e),i){const s=t+e,r=s>0?t/s*100:50;i.style.width=`${r}%`}}draw(){this.ctx.fillStyle="#050510",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.connections.forEach(t=>t.draw(this.ctx)),this.isDragging&&this.dragStartNode&&(this.ctx.beginPath(),this.ctx.strokeStyle="rgba(255, 255, 255, 0.5)",this.ctx.setLineDash([5,5]),this.ctx.moveTo(this.dragStartNode.x,this.dragStartNode.y),this.ctx.lineTo(this.mouseX,this.mouseY),this.ctx.stroke(),this.ctx.setLineDash([])),this.isCutting&&(this.ctx.beginPath(),this.ctx.strokeStyle="#ff0000",this.ctx.lineWidth=2,this.ctx.moveTo(this.cutStart.x,this.cutStart.y),this.ctx.lineTo(this.mouseX,this.mouseY),this.ctx.stroke()),this.nodes.forEach(t=>{const e=this.connections.filter(o=>o.from===t).length;t.draw(this.ctx,this.sprites,this.spritesLoaded,e)}),this.units.forEach(t=>t.draw(this.ctx,this.sprites,this.spritesLoaded))}handleInputStart(t){const e=this.canvas.getBoundingClientRect(),o=t.clientX-e.left,n=t.clientY-e.top,i=this.nodes.find(s=>s.contains(o,n));i&&i.owner==="player"?(this.isDragging=!0,this.dragStartNode=i):(this.isCutting=!0,this.cutStart={x:o,y:n},this.mouseX=o,this.mouseY=n)}handleInputMove(t){const e=this.canvas.getBoundingClientRect();this.mouseX=t.clientX-e.left,this.mouseY=t.clientY-e.top}handleInputEnd(t){if(this.isDragging&&this.dragStartNode){const e=this.canvas.getBoundingClientRect(),o=t.clientX-e.left,n=t.clientY-e.top,i=this.nodes.find(s=>s.contains(o,n));i&&i!==this.dragStartNode&&this.createConnection(this.dragStartNode,i)}else this.isCutting&&(this.connections=this.connections.filter(e=>!this.linesIntersect(this.cutStart,{x:this.mouseX,y:this.mouseY},e.from,e.to)));this.isDragging=!1,this.isCutting=!1,this.dragStartNode=null}createConnection(t,e){if(this.connections.filter(i=>i.from===t).length>=t.maxConnections)return;this.connections.find(i=>i.from===t&&i.to===e)||x(()=>import("./Connection-BlPXsYj8.js"),__vite__mapDeps([0,1])).then(i=>{const s=i.Connection;this.connections.push(new s(t,e))})}linesIntersect(t,e,o,n){const i=(e.x-t.x)*(n.y-o.y)-(n.x-o.x)*(e.y-t.y);if(i===0)return!1;const s=((n.y-o.y)*(n.x-t.x)+(o.x-n.x)*(n.y-t.y))/i,r=((t.y-e.y)*(n.x-t.x)+(e.x-t.x)*(n.y-t.y))/i;return 0<s&&s<1&&0<r&&r<1}}class f{constructor(t,e,o="neutral"){this.x=t,this.y=e,this.owner=o,this.value=10,this.capacity=50,this.radius=30,this.level=1,this.generationRate=1,this.maxConnections=1,this.timer=0,this.colors={player:"#00ff9d",enemy:"#ff3333",neutral:"#888888"}}update(t){this.value>=30&&this.level<3?(this.level=3,this.generationRate=3):this.value>=15&&this.level<2?(this.level=2,this.generationRate=1.5):this.value<15&&(this.level=1,this.generationRate=1),this.maxConnections=this.level,this.owner!=="neutral"&&this.value<this.capacity&&(this.timer+=t,this.timer>=1/this.generationRate&&(this.value++,this.timer=0))}draw(t,e,o,n=0){if(o){let i=6;this.owner==="player"?i=this.level-1:this.owner==="enemy"&&(i=3+(this.level-1));const s=this.radius*2.5;t.drawImage(e,i*64,0,64,64,this.x-s/2,this.y-s/2,s,s),this.owner!=="neutral"&&(t.shadowBlur=10+this.level*5,t.shadowColor=this.colors[this.owner],t.globalCompositeOperation="lighter",t.drawImage(e,i*64,0,64,64,this.x-s/2,this.y-s/2,s,s),t.globalCompositeOperation="source-over",t.shadowBlur=0)}else t.beginPath(),t.arc(this.x,this.y,this.radius,0,Math.PI*2),t.fillStyle="#1a1a1a",t.fill(),t.lineWidth=3,t.strokeStyle=this.colors[this.owner],t.stroke();if(t.font='bold 24px "Courier New", monospace',t.textAlign="center",t.textBaseline="middle",t.lineWidth=4,t.strokeStyle="#000000",t.strokeText(Math.floor(this.value),this.x,this.y+this.radius+25),t.fillStyle="#ffffff",t.fillText(Math.floor(this.value),this.x,this.y+this.radius+25),this.owner==="player"){const i=`${n}/${this.maxConnections}`;t.font='bold 14px "Courier New", monospace',t.fillStyle=n>=this.maxConnections?"#ff3333":"#00ff9d",t.strokeStyle="#000000",t.lineWidth=3,t.strokeText(i,this.x,this.y+this.radius+45),t.fillText(i,this.x,this.y+this.radius+45)}}contains(t,e){const o=this.x-t,n=this.y-e;return o*o+n*n<=this.radius*this.radius}}const C=document.getElementById("gameCanvas"),c=new E(C);c.nodes.push(new f(200,300,"player"));c.nodes.push(new f(600,300,"enemy"));c.nodes.push(new f(400,150,"neutral"));c.nodes.push(new f(400,450,"neutral"));c.nodes[0].value=10;c.start();export{x as _};
