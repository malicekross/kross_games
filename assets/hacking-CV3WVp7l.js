const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Connection-DUfeS9hR.js","assets/modulepreload-polyfill-B5Qt9EMX.js"])))=>i.map(i=>d[i]);
import"./modulepreload-polyfill-B5Qt9EMX.js";const w="modulepreload",y=function(u){return"/kross_games/"+u},m={},E=function(t,e,o){let i=Promise.resolve();if(e&&e.length>0){let p=function(a){return Promise.all(a.map(l=>Promise.resolve(l).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),r=n?.nonce||n?.getAttribute("nonce");i=p(e.map(a=>{if(a=y(a),a in m)return;m[a]=!0;const l=a.endsWith(".css"),d=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${d}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":w,l||(h.as="script"),h.crossOrigin="",h.href=a,r&&h.setAttribute("nonce",r),document.head.appendChild(h),l)return new Promise((g,v)=>{h.addEventListener("load",g),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${a}`)))})}))}function s(n){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=n,window.dispatchEvent(r),!r.defaultPrevented)throw n}return i.then(n=>{for(const r of n||[])r.status==="rejected"&&s(r.reason);return t().catch(s)})},S="/kross_games/assets/sprites-ClHaEWzu.svg";class I{constructor(t){this.canvas=t,this.ctx=t.getContext("2d"),this.nodes=[],this.units=[],this.connections=[],this.lastTime=0,this.resize(),window.addEventListener("resize",()=>this.resize()),this.isDragging=!1,this.dragStartNode=null,this.mouseX=0,this.mouseY=0,this.canvas.addEventListener("mousedown",e=>this.handleInputStart(e)),this.canvas.addEventListener("mousemove",e=>this.handleInputMove(e)),this.canvas.addEventListener("mouseup",e=>this.handleInputEnd(e)),this.sprites=new Image,this.sprites.src=S,this.spritesLoaded=!1,this.sprites.onload=()=>{this.spritesLoaded=!0}}resize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}start(){this.lastTime=performance.now(),requestAnimationFrame(t=>this.loop(t))}loop(t){const e=(t-this.lastTime)/1e3;this.lastTime=t,this.update(e),this.draw(),requestAnimationFrame(o=>this.loop(o))}update(t){this.nodes.forEach(e=>e.update(t)),this.connections.forEach(e=>e.update(t,this)),this.units.forEach(e=>e.update(t)),this.units=this.units.filter(e=>e.active),this.connections=this.connections.filter(e=>e.from.owner==="player"),this.updateScoreUI()}updateScoreUI(){let t=0,e=0;this.nodes.forEach(n=>{n.owner==="player"&&(t+=Math.floor(n.value)),n.owner==="enemy"&&(e+=Math.floor(n.value))}),this.units.forEach(n=>{n.owner==="player"&&t++,n.owner==="enemy"&&e++});const o=document.getElementById("player-score"),i=document.getElementById("enemy-score"),s=document.getElementById("score-bar-fill");if(o&&(o.innerText=t),i&&(i.innerText=e),s){const n=t+e,r=n>0?t/n*100:50;s.style.width=`${r}%`}}draw(){this.ctx.fillStyle="#050510",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.connections.forEach(t=>t.draw(this.ctx)),this.isDragging&&this.dragStartNode&&(this.ctx.beginPath(),this.ctx.strokeStyle="rgba(255, 255, 255, 0.5)",this.ctx.setLineDash([5,5]),this.ctx.moveTo(this.dragStartNode.x,this.dragStartNode.y),this.ctx.lineTo(this.mouseX,this.mouseY),this.ctx.stroke(),this.ctx.setLineDash([])),this.nodes.forEach(t=>t.draw(this.ctx,this.sprites,this.spritesLoaded)),this.units.forEach(t=>t.draw(this.ctx,this.sprites,this.spritesLoaded))}handleInputStart(t){const e=this.canvas.getBoundingClientRect(),o=t.clientX-e.left,i=t.clientY-e.top,s=this.nodes.find(n=>n.contains(o,i));s&&s.owner==="player"&&(this.isDragging=!0,this.dragStartNode=s)}handleInputMove(t){const e=this.canvas.getBoundingClientRect();this.mouseX=t.clientX-e.left,this.mouseY=t.clientY-e.top}handleInputEnd(t){if(this.isDragging&&this.dragStartNode){const e=this.canvas.getBoundingClientRect(),o=t.clientX-e.left,i=t.clientY-e.top,s=this.nodes.find(n=>n.contains(o,i));s&&s!==this.dragStartNode&&this.createConnection(this.dragStartNode,s)}this.isDragging=!1,this.dragStartNode=null}createConnection(t,e){this.connections.find(i=>i.from===t&&i.to===e)||E(()=>import("./Connection-DUfeS9hR.js"),__vite__mapDeps([0,1])).then(i=>{const s=i.Connection;this.connections.push(new s(t,e))})}}class f{constructor(t,e,o="neutral"){this.x=t,this.y=e,this.owner=o,this.value=10,this.capacity=50,this.radius=30,this.level=1,this.generationRate=1,this.timer=0,this.colors={player:"#00ff9d",enemy:"#ff3333",neutral:"#888888"}}update(t){this.value>=30&&this.level<3?(this.level=3,this.generationRate=3):this.value>=15&&this.level<2?(this.level=2,this.generationRate=1.5):this.value<15&&(this.level=1,this.generationRate=1),this.owner!=="neutral"&&this.value<this.capacity&&(this.timer+=t,this.timer>=1/this.generationRate&&(this.value++,this.timer=0))}draw(t,e,o){if(o){let i=6;this.owner==="player"?i=this.level-1:this.owner==="enemy"&&(i=3+(this.level-1));const s=this.radius*2.5;t.drawImage(e,i*64,0,64,64,this.x-s/2,this.y-s/2,s,s),this.owner!=="neutral"&&(t.shadowBlur=10+this.level*5,t.shadowColor=this.colors[this.owner],t.globalCompositeOperation="lighter",t.drawImage(e,i*64,0,64,64,this.x-s/2,this.y-s/2,s,s),t.globalCompositeOperation="source-over",t.shadowBlur=0)}else t.beginPath(),t.arc(this.x,this.y,this.radius,0,Math.PI*2),t.fillStyle="#1a1a1a",t.fill(),t.lineWidth=3,t.strokeStyle=this.colors[this.owner],t.stroke();t.font='bold 24px "Courier New", monospace',t.textAlign="center",t.textBaseline="middle",t.lineWidth=4,t.strokeStyle="#000000",t.strokeText(Math.floor(this.value),this.x,this.y+this.radius+25),t.fillStyle="#ffffff",t.fillText(Math.floor(this.value),this.x,this.y+this.radius+25)}contains(t,e){const o=this.x-t,i=this.y-e;return o*o+i*i<=this.radius*this.radius}}const C=document.getElementById("gameCanvas"),c=new I(C);c.nodes.push(new f(200,300,"player"));c.nodes.push(new f(600,300,"enemy"));c.nodes.push(new f(400,150,"neutral"));c.nodes.push(new f(400,450,"neutral"));c.nodes[0].value=10;c.start();export{E as _};
