import"./modulepreload-polyfill-B5Qt9EMX.js";const w="modulepreload",y=function(u){return"/kross_games/"+u},m={},S=function(t,e,s){let i=Promise.resolve();if(e&&e.length>0){let g=function(r){return Promise.all(r.map(l=>Promise.resolve(l).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),a=n?.nonce||n?.getAttribute("nonce");i=g(e.map(r=>{if(r=y(r),r in m)return;m[r]=!0;const l=r.endsWith(".css"),d=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${d}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":w,l||(h.as="script"),h.crossOrigin="",h.href=r,a&&h.setAttribute("nonce",a),document.head.appendChild(h),l)return new Promise((p,v)=>{h.addEventListener("load",p),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${r}`)))})}))}function o(n){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=n,window.dispatchEvent(a),!a.defaultPrevented)throw n}return i.then(n=>{for(const a of n||[])a.status==="rejected"&&o(a.reason);return t().catch(o)})};class E{constructor(t){this.canvas=t,this.ctx=t.getContext("2d"),this.nodes=[],this.units=[],this.connections=[],this.lastTime=0,this.resize(),window.addEventListener("resize",()=>this.resize()),this.isDragging=!1,this.dragStartNode=null,this.mouseX=0,this.mouseY=0,this.canvas.addEventListener("mousedown",e=>this.handleInputStart(e)),this.canvas.addEventListener("mousemove",e=>this.handleInputMove(e)),this.canvas.addEventListener("mouseup",e=>this.handleInputEnd(e))}resize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}start(){this.lastTime=performance.now(),requestAnimationFrame(t=>this.loop(t))}loop(t){const e=(t-this.lastTime)/1e3;this.lastTime=t,this.update(e),this.draw(),requestAnimationFrame(s=>this.loop(s))}update(t){this.nodes.forEach(e=>e.update(t)),this.units.forEach(e=>e.update(t)),this.units=this.units.filter(e=>e.active)}draw(){this.ctx.fillStyle="#050510",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.strokeStyle="rgba(0, 255, 157, 0.2)",this.ctx.lineWidth=2,this.connections.forEach(t=>{this.ctx.beginPath(),this.ctx.moveTo(t.from.x,t.from.y),this.ctx.lineTo(t.to.x,t.to.y),this.ctx.stroke()}),this.isDragging&&this.dragStartNode&&(this.ctx.beginPath(),this.ctx.strokeStyle="rgba(255, 255, 255, 0.5)",this.ctx.setLineDash([5,5]),this.ctx.moveTo(this.dragStartNode.x,this.dragStartNode.y),this.ctx.lineTo(this.mouseX,this.mouseY),this.ctx.stroke(),this.ctx.setLineDash([])),this.nodes.forEach(t=>t.draw(this.ctx)),this.units.forEach(t=>t.draw(this.ctx))}handleInputStart(t){const e=this.canvas.getBoundingClientRect(),s=t.clientX-e.left,i=t.clientY-e.top,o=this.nodes.find(n=>n.contains(s,i));o&&o.owner==="player"&&(this.isDragging=!0,this.dragStartNode=o)}handleInputMove(t){const e=this.canvas.getBoundingClientRect();this.mouseX=t.clientX-e.left,this.mouseY=t.clientY-e.top}handleInputEnd(t){if(this.isDragging&&this.dragStartNode){const e=this.canvas.getBoundingClientRect(),s=t.clientX-e.left,i=t.clientY-e.top,o=this.nodes.find(n=>n.contains(s,i));o&&o!==this.dragStartNode&&this.spawnUnits(this.dragStartNode,o)}this.isDragging=!1,this.dragStartNode=null}spawnUnits(t,e){const s=Math.floor(t.value/2);if(s>0){t.value-=s;for(let i=0;i<s;i++)setTimeout(()=>{S(()=>import("./Unit-DN1aTxwt.js"),[]).then(o=>{const n=o.Unit;this.units.push(new n(t.x,t.y,e,t.owner))})},i*100)}}}class f{constructor(t,e,s="neutral"){this.x=t,this.y=e,this.owner=s,this.value=10,this.capacity=50,this.radius=30,this.generationRate=1,this.timer=0,this.colors={player:"#00ff9d",enemy:"#ff3333",neutral:"#888888"}}update(t){this.owner!=="neutral"&&this.value<this.capacity&&(this.timer+=t,this.timer>=1/this.generationRate&&(this.value++,this.timer=0))}draw(t){t.beginPath(),t.arc(this.x,this.y,this.radius,0,Math.PI*2),t.fillStyle="#1a1a1a",t.fill(),t.lineWidth=3,t.strokeStyle=this.colors[this.owner],t.stroke(),this.owner!=="neutral"&&(t.shadowBlur=15,t.shadowColor=this.colors[this.owner],t.stroke(),t.shadowBlur=0),t.fillStyle="#ffffff",t.font="16px Outfit, sans-serif",t.textAlign="center",t.textBaseline="middle",t.fillText(Math.floor(this.value),this.x,this.y)}contains(t,e){const s=this.x-t,i=this.y-e;return s*s+i*i<=this.radius*this.radius}sendUnits(t,e){const s=Math.floor(this.value/2);s>0&&(this.value-=s,console.log(`Sending ${s} units from ${this.owner} to ${t.owner}`))}}const x=document.getElementById("gameCanvas"),c=new E(x);c.nodes.push(new f(200,300,"player"));c.nodes.push(new f(600,300,"enemy"));c.nodes.push(new f(400,150,"neutral"));c.nodes.push(new f(400,450,"neutral"));c.nodes[0].value=30;c.start();
