const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Connection-Dd-4IRn4.js","assets/modulepreload-polyfill-B5Qt9EMX.js"])))=>i.map(i=>d[i]);
import"./modulepreload-polyfill-B5Qt9EMX.js";const m="modulepreload",v=function(f){return"/kross_games/"+f},p={},w=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(c=>Promise.resolve(c).then(a=>({status:"fulfilled",value:a}),a=>({status:"rejected",reason:a}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=s?.nonce||s?.getAttribute("nonce");i=u(t.map(h=>{if(h=v(h),h in p)return;p[h]=!0;const c=h.endsWith(".css"),a=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${a}`))return;const l=document.createElement("link");if(l.rel=c?"stylesheet":m,c||(l.as="script"),l.crossOrigin="",l.href=h,o&&l.setAttribute("nonce",o),document.head.appendChild(l),c)return new Promise((x,g)=>{l.addEventListener("load",x),l.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${h}`)))})}))}function r(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return i.then(s=>{for(const o of s||[])o.status==="rejected"&&r(o.reason);return e().catch(r)})},E="/kross_games/assets/sprites-ClHaEWzu.svg",S="data:image/svg+xml,%3csvg%20width='96'%20height='32'%20viewBox='0%200%2096%2032'%20xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3cstyle%3e%20.neon-green%20{%20fill:%20%2300FF00;%20}%20%3c/style%3e%3crect%20id='p'%20width='2'%20height='2'%20class='neon-green'/%3e%3c/defs%3e%3cg%20id='frame1'%3e%3cuse%20href='%23p'%20x='0'%20y='14'/%3e%3cuse%20href='%23p'%20x='2'%20y='14'/%3e%3cuse%20href='%23p'%20x='0'%20y='16'/%3e%3cuse%20href='%23p'%20x='2'%20y='16'/%3e%3cuse%20href='%23p'%20x='4'%20y='12'/%3e%3cuse%20href='%23p'%20x='6'%20y='12'/%3e%3cuse%20href='%23p'%20x='4'%20y='14'/%3e%3cuse%20href='%23p'%20x='6'%20y='14'/%3e%3cuse%20href='%23p'%20x='8'%20y='10'/%3e%3cuse%20href='%23p'%20x='10'%20y='10'/%3e%3cuse%20href='%23p'%20x='8'%20y='12'/%3e%3cuse%20href='%23p'%20x='10'%20y='12'/%3e%3cuse%20href='%23p'%20x='12'%20y='12'/%3e%3cuse%20href='%23p'%20x='14'%20y='12'/%3e%3cuse%20href='%23p'%20x='12'%20y='14'/%3e%3cuse%20href='%23p'%20x='14'%20y='14'/%3e%3cuse%20href='%23p'%20x='16'%20y='14'/%3e%3cuse%20href='%23p'%20x='18'%20y='14'/%3e%3cuse%20href='%23p'%20x='16'%20y='16'/%3e%3cuse%20href='%23p'%20x='18'%20y='16'/%3e%3cuse%20href='%23p'%20x='20'%20y='16'/%3e%3cuse%20href='%23p'%20x='22'%20y='16'/%3e%3cuse%20href='%23p'%20x='20'%20y='18'/%3e%3cuse%20href='%23p'%20x='22'%20y='18'/%3e%3cuse%20href='%23p'%20x='24'%20y='18'/%3e%3cuse%20href='%23p'%20x='26'%20y='18'/%3e%3cuse%20href='%23p'%20x='24'%20y='20'/%3e%3cuse%20href='%23p'%20x='26'%20y='20'/%3e%3cuse%20href='%23p'%20x='28'%20y='16'/%3e%3cuse%20href='%23p'%20x='30'%20y='16'/%3e%3cuse%20href='%23p'%20x='28'%20y='18'/%3e%3cuse%20href='%23p'%20x='30'%20y='18'/%3e%3c/g%3e%3cg%20id='frame2'%20transform='translate(32,%200)'%3e%3cuse%20href='%23p'%20x='0'%20y='18'/%3e%3cuse%20href='%23p'%20x='2'%20y='18'/%3e%3cuse%20href='%23p'%20x='0'%20y='20'/%3e%3cuse%20href='%23p'%20x='2'%20y='20'/%3e%3cuse%20href='%23p'%20x='4'%20y='16'/%3e%3cuse%20href='%23p'%20x='6'%20y='16'/%3e%3cuse%20href='%23p'%20x='4'%20y='18'/%3e%3cuse%20href='%23p'%20x='6'%20y='18'/%3e%3cuse%20href='%23p'%20x='8'%20y='14'/%3e%3cuse%20href='%23p'%20x='10'%20y='14'/%3e%3cuse%20href='%23p'%20x='8'%20y='16'/%3e%3cuse%20href='%23p'%20x='10'%20y='16'/%3e%3cuse%20href='%23p'%20x='12'%20y='12'/%3e%3cuse%20href='%23p'%20x='14'%20y='12'/%3e%3cuse%20href='%23p'%20x='12'%20y='14'/%3e%3cuse%20href='%23p'%20x='14'%20y='14'/%3e%3cuse%20href='%23p'%20x='16'%20y='10'/%3e%3cuse%20href='%23p'%20x='18'%20y='10'/%3e%3cuse%20href='%23p'%20x='16'%20y='12'/%3e%3cuse%20href='%23p'%20x='18'%20y='12'/%3e%3cuse%20href='%23p'%20x='20'%20y='12'/%3e%3cuse%20href='%23p'%20x='22'%20y='12'/%3e%3cuse%20href='%23p'%20x='20'%20y='14'/%3e%3cuse%20href='%23p'%20x='22'%20y='14'/%3e%3cuse%20href='%23p'%20x='24'%20y='14'/%3e%3cuse%20href='%23p'%20x='26'%20y='14'/%3e%3cuse%20href='%23p'%20x='24'%20y='16'/%3e%3cuse%20href='%23p'%20x='26'%20y='16'/%3e%3cuse%20href='%23p'%20x='28'%20y='16'/%3e%3cuse%20href='%23p'%20x='30'%20y='16'/%3e%3cuse%20href='%23p'%20x='28'%20y='18'/%3e%3cuse%20href='%23p'%20x='30'%20y='18'/%3e%3c/g%3e%3cg%20id='frame3'%20transform='translate(64,%200)'%3e%3cuse%20href='%23p'%20x='0'%20y='12'/%3e%3cuse%20href='%23p'%20x='2'%20y='12'/%3e%3cuse%20href='%23p'%20x='0'%20y='14'/%3e%3cuse%20href='%23p'%20x='2'%20y='14'/%3e%3cuse%20href='%23p'%20x='4'%20y='14'/%3e%3cuse%20href='%23p'%20x='6'%20y='14'/%3e%3cuse%20href='%23p'%20x='4'%20y='16'/%3e%3cuse%20href='%23p'%20x='6'%20y='16'/%3e%3cuse%20href='%23p'%20x='8'%20y='16'/%3e%3cuse%20href='%23p'%20x='10'%20y='16'/%3e%3cuse%20href='%23p'%20x='8'%20y='18'/%3e%3cuse%20href='%23p'%20x='10'%20y='18'/%3e%3cuse%20href='%23p'%20x='12'%20y='18'/%3e%3cuse%20href='%23p'%20x='14'%20y='18'/%3e%3cuse%20href='%23p'%20x='12'%20y='20'/%3e%3cuse%20href='%23p'%20x='14'%20y='20'/%3e%3cuse%20href='%23p'%20x='16'%20y='16'/%3e%3cuse%20href='%23p'%20x='18'%20y='16'/%3e%3cuse%20href='%23p'%20x='16'%20y='18'/%3e%3cuse%20href='%23p'%20x='18'%20y='18'/%3e%3cuse%20href='%23p'%20x='20'%20y='14'/%3e%3cuse%20href='%23p'%20x='22'%20y='14'/%3e%3cuse%20href='%23p'%20x='20'%20y='16'/%3e%3cuse%20href='%23p'%20x='22'%20y='16'/%3e%3cuse%20href='%23p'%20x='24'%20y='12'/%3e%3cuse%20href='%23p'%20x='26'%20y='12'/%3e%3cuse%20href='%23p'%20x='24'%20y='14'/%3e%3cuse%20href='%23p'%20x='26'%20y='14'/%3e%3cuse%20href='%23p'%20x='28'%20y='10'/%3e%3cuse%20href='%23p'%20x='30'%20y='10'/%3e%3cuse%20href='%23p'%20x='28'%20y='12'/%3e%3cuse%20href='%23p'%20x='30'%20y='12'/%3e%3c/g%3e%3c/svg%3e";class C{constructor(e,t,n="neutral"){this.x=e,this.y=t,this.owner=n,this.value=10,this.capacity=50,this.radius=30,this.level=1,this.generationRate=1.1,this.maxConnections=1,this.timer=0,this.colors={player:"#00ff9d",enemy:"#ff3333",neutral:"#888888"}}update(e){this.value>=30&&this.level<3?(this.level=3,this.generationRate=3.3):this.value>=15&&this.level<2?(this.level=2,this.generationRate=2.2):this.value<15&&(this.level=1,this.generationRate=1.1),this.maxConnections=this.level,this.owner!=="neutral"&&this.value<this.capacity&&(this.timer+=e,this.timer>=1/this.generationRate&&(this.value++,this.timer=0))}draw(e,t,n,i=0){if(n){let r=6;this.owner==="player"?r=this.level-1:this.owner==="enemy"&&(r=3+(this.level-1));const s=this.radius*2.5;e.drawImage(t,r*64,0,64,64,this.x-s/2,this.y-s/2,s,s),this.owner!=="neutral"&&(e.shadowBlur=10+this.level*5,e.shadowColor=this.colors[this.owner],e.globalCompositeOperation="lighter",e.drawImage(t,r*64,0,64,64,this.x-s/2,this.y-s/2,s,s),e.globalCompositeOperation="source-over",e.shadowBlur=0)}else e.beginPath(),e.arc(this.x,this.y,this.radius,0,Math.PI*2),e.fillStyle="#1a1a1a",e.fill(),e.lineWidth=3,e.strokeStyle=this.colors[this.owner],e.stroke();if(e.font='bold 24px "Courier New", monospace',e.textAlign="center",e.textBaseline="middle",e.shadowBlur=4,e.shadowColor="#000000",e.lineWidth=4,e.strokeStyle="#000000",e.strokeText(Math.floor(this.value),this.x,this.y),e.shadowBlur=0,e.fillStyle="#ffffff",e.fillText(Math.floor(this.value),this.x,this.y),this.owner==="player"){const o=this.x-(this.maxConnections-1)*12/2,u=this.y+this.radius+15;for(let h=0;h<this.maxConnections;h++)e.beginPath(),e.arc(o+h*12,u,4,0,Math.PI*2),h<i&&(e.fillStyle="#00ff9d",e.fill()),e.strokeStyle="#00ff9d",e.lineWidth=1.5,e.stroke()}}contains(e,t){const n=this.x-e,i=this.y-t;return n*n+i*i<=this.radius*this.radius}}class I{constructor(e){this.canvas=e,this.ctx=e.getContext("2d"),this.nodes=[],this.units=[],this.connections=[],this.lastTime=0,this.resize(),window.addEventListener("resize",()=>this.resize()),this.isDragging=!1,this.isCutting=!1,this.dragStartNode=null,this.cutStart={x:0,y:0},this.mouseX=0,this.mouseY=0,this.canvas.addEventListener("mousedown",t=>this.handleInputStart(t)),this.canvas.addEventListener("mousemove",t=>this.handleInputMove(t)),this.canvas.addEventListener("mouseup",t=>this.handleInputEnd(t)),this.canvas.addEventListener("touchstart",t=>{t.preventDefault(),this.handleInputStart(t.touches[0])},{passive:!1}),this.canvas.addEventListener("touchmove",t=>{t.preventDefault(),this.handleInputMove(t.touches[0])},{passive:!1}),this.canvas.addEventListener("touchend",t=>{t.preventDefault(),this.handleInputEnd(t.changedTouches[0])},{passive:!1}),this.sprites=new Image,this.sprites.src=E,this.spritesLoaded=!1,this.sprites.onload=()=>{this.spritesLoaded=!0},this.sprites.onerror=t=>{console.error("Error loading sprites")},this.wireSprite=new Image,this.wireSprite.src=S,this.wireSpriteLoaded=!1,this.wireSprite.onload=()=>{this.wireSpriteLoaded=!0},this.wireSprite.onerror=t=>{console.error("Error loading wire sprite")},console.log("Game initialized")}generateLevel(){this.nodes=[],this.units=[],this.connections=[];const e=Math.floor(Math.random()*6)+5,t=100,n=150;console.log(`Target Node Count: ${e}, Canvas: ${this.canvas.width}x${this.canvas.height}`);for(let i=0;i<e;i++){let r=!1,s,o,u=0;for(;!r&&u<100;){s=t+Math.random()*(this.canvas.width-t*2),o=t+Math.random()*(this.canvas.height-t*2),r=!0;for(const h of this.nodes){const c=h.x-s,a=h.y-o;if(Math.sqrt(c*c+a*a)<n){r=!1;break}}u++}if(r){let h="neutral";i===0&&(h="player"),i===1&&(h="enemy");const c=new C(s,o,h);h==="player"&&(c.value=10),this.nodes.push(c)}else console.warn("Failed to place node after 100 attempts")}console.log(`Total Nodes: ${this.nodes.length}`)}resize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,console.log(`Resized Canvas to ${this.canvas.width}x${this.canvas.height}`)}start(){this.lastTime=performance.now(),requestAnimationFrame(e=>this.loop(e))}loop(e){let t=(e-this.lastTime)/1e3;this.lastTime=e,t>.1&&(t=.1),this.update(t),this.draw(),requestAnimationFrame(n=>this.loop(n))}update(e){this.nodes.forEach(t=>t.update(e)),this.connections.forEach(t=>t.update(e,this)),this.units.forEach(t=>t.update(e)),this.units=this.units.filter(t=>t.active),this.connections=this.connections.filter(t=>t.from.owner==="player"),this.updateScoreUI(),this.checkWinCondition()}checkWinCondition(){let e=0;if(this.nodes.forEach(t=>{t.owner==="enemy"&&(e+=Math.floor(t.value))}),this.units.forEach(t=>{t.owner==="enemy"&&e++}),e===0){const t=document.getElementById("victory-screen");t&&(t.style.display="flex")}}updateScoreUI(){let e=0,t=0;this.nodes.forEach(s=>{s.owner==="player"&&(e+=Math.floor(s.value)),s.owner==="enemy"&&(t+=Math.floor(s.value))}),this.units.forEach(s=>{s.owner==="player"&&e++,s.owner==="enemy"&&t++});const n=document.getElementById("player-score"),i=document.getElementById("enemy-score"),r=document.getElementById("score-bar-fill");if(n&&(n.innerText=e),i&&(i.innerText=t),r){const s=e+t,o=s>0?e/s*100:50;r.style.width=`${o}%`}}draw(){this.ctx.fillStyle="#050510",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.connections.forEach(e=>e.draw(this.ctx,this)),this.isDragging&&this.dragStartNode&&(this.ctx.beginPath(),this.ctx.strokeStyle="rgba(255, 255, 255, 0.5)",this.ctx.setLineDash([5,5]),this.ctx.moveTo(this.dragStartNode.x,this.dragStartNode.y),this.ctx.lineTo(this.mouseX,this.mouseY),this.ctx.stroke(),this.ctx.setLineDash([])),this.isCutting&&(this.ctx.beginPath(),this.ctx.strokeStyle="#ff0000",this.ctx.lineWidth=2,this.ctx.moveTo(this.cutStart.x,this.cutStart.y),this.ctx.lineTo(this.mouseX,this.mouseY),this.ctx.stroke()),this.nodes.forEach(e=>{const t=this.connections.filter(n=>n.from===e).length;e.draw(this.ctx,this.sprites,this.spritesLoaded,t)}),this.units.forEach(e=>e.draw(this.ctx,this.sprites,this.spritesLoaded))}handleInputStart(e){const t=this.canvas.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top,r=this.nodes.find(s=>s.contains(n,i));r&&r.owner==="player"?(this.isDragging=!0,this.dragStartNode=r):(this.isCutting=!0,this.cutStart={x:n,y:i},this.mouseX=n,this.mouseY=i)}handleInputMove(e){const t=this.canvas.getBoundingClientRect();this.mouseX=e.clientX-t.left,this.mouseY=e.clientY-t.top}handleInputEnd(e){const t=this.canvas.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top;if(this.isDragging&&this.dragStartNode){const r=this.nodes.find(s=>s.contains(n,i));r&&r!==this.dragStartNode&&this.createConnection(this.dragStartNode,r)}else if(this.isCutting){const r=this.connections.filter(s=>this.linesIntersect(this.cutStart,{x:this.mouseX,y:this.mouseY},s.from,s.to));this.connections=this.connections.filter(s=>!r.includes(s)),r.forEach(s=>{this.units.forEach(o=>{o.source===s.from&&o.target===s.to&&o.active&&o.hitTarget()})})}this.isDragging=!1,this.isCutting=!1,this.dragStartNode=null}createConnection(e,t){if(this.connections.find(s=>s.from===e&&s.to===t))return;const i=this.connections.find(s=>s.from===t&&s.to===e);this.connections.filter(s=>s.from===e).length>=e.maxConnections||(i&&(this.connections=this.connections.filter(s=>s!==i)),w(()=>import("./Connection-Dd-4IRn4.js"),__vite__mapDeps([0,1])).then(s=>{const o=s.Connection;this.connections.push(new o(e,t))}))}linesIntersect(e,t,n,i){const r=(t.x-e.x)*(i.y-n.y)-(i.x-n.x)*(t.y-e.y);if(r===0)return!1;const s=((i.y-n.y)*(i.x-e.x)+(n.x-i.x)*(i.y-e.y))/r,o=((e.y-t.y)*(i.x-e.x)+(t.x-e.x)*(i.y-e.y))/r;return 0<s&&s<1&&0<o&&o<1}}const d=document.createElement("canvas");document.body.appendChild(d);const y=new I(d);y.generateLevel();y.start();export{w as _};
