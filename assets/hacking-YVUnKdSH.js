import"./modulepreload-polyfill-B5Qt9EMX.js";const v="modulepreload",y=function(u){return"/kross_games/"+u},m={},S=function(t,e,s){let n=Promise.resolve();if(e&&e.length>0){let g=function(r){return Promise.all(r.map(l=>Promise.resolve(l).then(c=>({status:"fulfilled",value:c}),c=>({status:"rejected",reason:c}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");n=g(e.map(r=>{if(r=y(r),r in m)return;m[r]=!0;const l=r.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${c}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":v,l||(h.as="script"),h.crossOrigin="",h.href=r,a&&h.setAttribute("nonce",a),document.head.appendChild(h),l)return new Promise((p,w)=>{h.addEventListener("load",p),h.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${r}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})},E="/kross_games/assets/sprites-CoWFfSzm.svg";class x{constructor(t){this.canvas=t,this.ctx=t.getContext("2d"),this.nodes=[],this.units=[],this.connections=[],this.lastTime=0,this.resize(),window.addEventListener("resize",()=>this.resize()),this.isDragging=!1,this.dragStartNode=null,this.mouseX=0,this.mouseY=0,this.canvas.addEventListener("mousedown",e=>this.handleInputStart(e)),this.canvas.addEventListener("mousemove",e=>this.handleInputMove(e)),this.canvas.addEventListener("mouseup",e=>this.handleInputEnd(e)),this.sprites=new Image,this.sprites.src=E,this.spritesLoaded=!1,this.sprites.onload=()=>{this.spritesLoaded=!0}}resize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}start(){this.lastTime=performance.now(),requestAnimationFrame(t=>this.loop(t))}loop(t){const e=(t-this.lastTime)/1e3;this.lastTime=t,this.update(e),this.draw(),requestAnimationFrame(s=>this.loop(s))}update(t){this.nodes.forEach(e=>e.update(t)),this.units.forEach(e=>e.update(t)),this.units=this.units.filter(e=>e.active)}draw(){this.ctx.fillStyle="#050510",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.strokeStyle="rgba(0, 255, 157, 0.2)",this.ctx.lineWidth=2,this.connections.forEach(t=>{this.ctx.beginPath(),this.ctx.moveTo(t.from.x,t.from.y),this.ctx.lineTo(t.to.x,t.to.y),this.ctx.stroke()}),this.isDragging&&this.dragStartNode&&(this.ctx.beginPath(),this.ctx.strokeStyle="rgba(255, 255, 255, 0.5)",this.ctx.setLineDash([5,5]),this.ctx.moveTo(this.dragStartNode.x,this.dragStartNode.y),this.ctx.lineTo(this.mouseX,this.mouseY),this.ctx.stroke(),this.ctx.setLineDash([])),this.nodes.forEach(t=>t.draw(this.ctx,this.sprites,this.spritesLoaded)),this.units.forEach(t=>t.draw(this.ctx,this.sprites,this.spritesLoaded))}handleInputStart(t){const e=this.canvas.getBoundingClientRect(),s=t.clientX-e.left,n=t.clientY-e.top,i=this.nodes.find(o=>o.contains(s,n));i&&i.owner==="player"&&(this.isDragging=!0,this.dragStartNode=i)}handleInputMove(t){const e=this.canvas.getBoundingClientRect();this.mouseX=t.clientX-e.left,this.mouseY=t.clientY-e.top}handleInputEnd(t){if(this.isDragging&&this.dragStartNode){const e=this.canvas.getBoundingClientRect(),s=t.clientX-e.left,n=t.clientY-e.top,i=this.nodes.find(o=>o.contains(s,n));i&&i!==this.dragStartNode&&this.spawnUnits(this.dragStartNode,i)}this.isDragging=!1,this.dragStartNode=null}spawnUnits(t,e){const s=Math.floor(t.value/2);if(s>0){t.value-=s;for(let n=0;n<s;n++)setTimeout(()=>{S(()=>import("./Unit-CeNgssQ-.js"),[]).then(i=>{const o=i.Unit;this.units.push(new o(t.x,t.y,e,t.owner))})},n*100)}}}class f{constructor(t,e,s="neutral"){this.x=t,this.y=e,this.owner=s,this.value=10,this.capacity=50,this.radius=30,this.generationRate=1,this.timer=0,this.colors={player:"#00ff9d",enemy:"#ff3333",neutral:"#888888"}}update(t){this.owner!=="neutral"&&this.value<this.capacity&&(this.timer+=t,this.timer>=1/this.generationRate&&(this.value++,this.timer=0))}draw(t,e,s){if(s){let n=2;this.owner==="player"&&(n=0),this.owner==="enemy"&&(n=1);const i=this.radius*2.5;t.drawImage(e,n*64,0,64,64,this.x-i/2,this.y-i/2,i,i),this.owner!=="neutral"&&(t.shadowBlur=10,t.shadowColor=this.colors[this.owner],t.globalCompositeOperation="lighter",t.drawImage(e,n*64,0,64,64,this.x-i/2,this.y-i/2,i,i),t.globalCompositeOperation="source-over",t.shadowBlur=0)}else t.beginPath(),t.arc(this.x,this.y,this.radius,0,Math.PI*2),t.fillStyle="#1a1a1a",t.fill(),t.lineWidth=3,t.strokeStyle=this.colors[this.owner],t.stroke();t.font='bold 24px "Courier New", monospace',t.textAlign="center",t.textBaseline="middle",t.lineWidth=4,t.strokeStyle="#000000",t.strokeText(Math.floor(this.value),this.x,this.y+this.radius+25),t.fillStyle="#ffffff",t.fillText(Math.floor(this.value),this.x,this.y+this.radius+25)}contains(t,e){const s=this.x-t,n=this.y-e;return s*s+n*n<=this.radius*this.radius}sendUnits(t,e){const s=Math.floor(this.value/2);s>0&&(this.value-=s,console.log(`Sending ${s} units from ${this.owner} to ${t.owner}`))}}const N=document.getElementById("gameCanvas"),d=new x(N);d.nodes.push(new f(200,300,"player"));d.nodes.push(new f(600,300,"enemy"));d.nodes.push(new f(400,150,"neutral"));d.nodes.push(new f(400,450,"neutral"));d.nodes[0].value=30;d.start();
